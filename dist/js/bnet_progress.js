function fetchRaid(e,a){$.ajax({url:"https://eu.api.blizzard.com/wow/zone/"+e+"?locale=en_GB&access_token="+token,type:"GET",success:function(r){renderRaid(r,e,a)},error:handleAjaxError})}function fetchRaiderIO(e,a,r){$.ajax({url:"https://raider.io/api/v1/raiding/raid-rankings?raid="+e+"&difficulty="+a+"&region=eu&realm=connected-alonsus",type:"GET",success:function(e){var n=$.grep(e.raidRankings,function(e,a){return 48482==e.guild.id});n&&0!=n.length&&r(n[0],a)}})}function renderRaid(e,a,r){"9389"==a?slugs=[{slug:"taloc",full_slug:"taloc",img_slug:"taloc"},{slug:"mother",full_slug:"mother",img_slug:"mother"},{slug:"fetid-devourer",full_slug:"fetid-devourer",img_slug:"fetiddevourer"},{slug:"zekvoz",full_slug:"zekvoz-herald-of-nzoth",img_slug:"zekvozheraldofnzoth"},{slug:"vectis",full_slug:"vectis",img_slug:"vectis"},{slug:"zul",full_slug:"zul-reborn",img_slug:"zulreborn"},{slug:"mythrax",full_slug:"mythrax-the-unraveler",img_slug:"mythraxtheunraveler"},{slug:"ghuun",full_slug:"ghuun",img_slug:"ghuun"}]:"8670"==a&&(slugs=[{slug:"champion-of-the-light",full_slug:"champion-of-the-light",img_slug:"rawani-kanae"},{slug:"jadefire-masters",full_slug:"jadefire-masters",img_slug:"mara-grimfang"},{slug:"grong-the-revenant",full_slug:"grong",img_slug:"grong-the-revenant"},{slug:"opulence",full_slug:"opulence",img_slug:"treasure-guardian"},{slug:"conclave-of-the-chosen",full_slug:"conclave-of-the-chosen",img_slug:"gonks-aspect"},{slug:"king-rastakhan",full_slug:"king-rastakhan",img_slug:"king-rastakhan"},{slug:"mekkatorque",full_slug:"high-tinker-mekkatorque",img_slug:"mekkatorque"},{slug:"stormwall-blockade",full_slug:"laminaria",img_slug:"laminaria"},{slug:"lady-jaina-proudmoore",full_slug:"lady-jaina-proudmoore",img_slug:"lady-jaina-proudmoore"}]);var n=$('.progress_data[data-zoneid="'+a+'"]');$('.loading[data-zoneid="'+a+'"]');n.prepend('<p class="hidden-xs col-xs-12 col-lg-10 col-lg-offset-1 text-center">'+e.description+"</p>");var l=0;$.each(e.bosses,function(e,a){if("144680"==a.id||"144637"==a.id||"144690"==a.id);else{l+=1;var r,t,o=a.urlSlug,i=$.grep(slugs,function(e,a){return e.slug==o});i&&0!=i.length&&(t=i[0].full_slug,r=i[0].img_slug),n.append('<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3"><div class="boss" style="background-image:url(http://wow.zamimg.com/images/wow/journal/ui-ej-boss-'+r+'.png)" id="'+a.id+'" data-slug="'+t+'"><h3 class="center-block"><a href="https://www.wowhead.com/npc='+a.id+'">'+a.name+'</a></h3><div class="text-center mode"></div><div class="text-center date"></div></div></div>')}}),$('.prog_bar[data-zoneid="'+a+'"]').attr("data-total",l),fillRaid(a,r)}function fillRaid(e,a){function r(a,r){console.log(a);var n=0;$.each(a.encountersDefeated,function(e,a){n+=1;var l=$('.boss[data-slug="'+a.slug+'"]'),t='<span class="glyphicon glyphicon-star" aria-hidden="true"></span> '+r+' <span class="glyphicon glyphicon-star" aria-hidden="true"></span>',o=new Date(a.firstDefeated);o="Defeated "+timeConverter(o),"heroic"==r&&1==l.hasClass("mythic")?l.removeClass("heroic"):(l.addClass("complete "+r),l.find(".mode").html(t),l.find(".date").html(o))}),renderRank(a,e),"normal"!=r&&renderProgBar(r,e,n),progComplete(e)}fetchRaiderIO(a,"normal",r),fetchRaiderIO(a,"heroic",r),fetchRaiderIO(a,"mythic",r)}function renderProgBar(e,a,r){var n=$(".prog_bar."+e+'[data-zoneid="'+a+'"]'),l=n.attr("data-total"),t=(r/l*100).toFixed(0);n.find(".progress").attr("data-original-title","Defeated "+r+" of "+l),n.find(".progress-bar").attr("aria-valuenow",t).html(t+"%").css("width",t+"%"),$('[data-toggle="tooltip"]').tooltip()}function progComplete(e){$('.loading[data-zoneid="'+e+'"]').hide(),$('.progress_data[data-zoneid="'+e+'"]').fadeIn()}function renderRank(e,a){console.log(a+" - "+currentRealm),(0==currentRealm||e.rank<currentRealm||0!=e.rank)&&(console.log(e.rank),console.log(currentRealm),currentRealm=e.rank,$('.progress_data[data-zoneid="'+a+'"]').find(".realm .rank_number").html(e.rank),$('.progress_data[data-zoneid="'+a+'"]').find(".rank").fadeIn()),(0==currentRegion||e.regionRank<currentRegion||0!=e.regionRank)&&(currentRegion=e.regionRank,$('.progress_data[data-zoneid="'+a+'"]').find(".region .rank_number").html(e.regionRank),$('.progress_data[data-zoneid="'+a+'"]').find(".rank").fadeIn())}function timeConverter(e){var a=new Date(e),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=a.getFullYear(),l=r[a.getMonth()],t=a.getDate(),o=(a.getHours(),a.getMinutes(),a.getSeconds(),[1,21,31]),i=[2,22],s=[3,23],u=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,24,25,26,27,28,29,30];return-1!=o.indexOf(t)?t+="st":-1!=i.indexOf(t)?t+="nd":-1!=s.indexOf(t)?t+="rd":-1!=u.indexOf(t)&&(t+="th"),t+" "+l+" "+n}function handleAjaxError(e,a,r){503==e.status?($("#error_503").fadeIn(),$(".progress_container").hide()):504==e.status&&($("#error_504").fadeIn(),$(".progress_container").hide())}function loadFinished(){$.getScript("https://wow.zamimg.com/widgets/power.js"),wowhead_tooltips={colorlinks:!0,iconizelinks:!0,renamelinks:!1}}var currentRealm=0,currentRegion=0;$(function(){function e(){fetchRaid(9389,"uldir"),fetchRaid(8670,"battle-of-dazaralor")}token(e)});